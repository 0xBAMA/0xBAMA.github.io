<!DOCTYPE html>
<html>
<head>
<style>
body {
	font-family: 'Rokkitt', serif;
	color:#481203;
    background-color: #ff9123;
    margin: 50px 50px 50px 100px;
    line-height: 5px;
}

</style>

<style>
@import url('https://fonts.googleapis.com/css2?family=Rokkitt:wght@600&display=swap');
</style>

<script type="application/javascript">
            var oldImageData;
            var newImageData;
            var outputImageData;

            var paletteR = [];
            var paletteG = [];
            var paletteB = [];

			function startfire()
			{
				//get your context stuff
				canvas = document.getElementById('fire');
				ctx = canvas.getContext('2d');

				//establish width
				width = ctx.canvas.width  = 768;
				height = ctx.canvas.height = 75;

                gen_palette();

				//initially fill with all black
				ctx.fillStyle = 'rgb(0,0,0,255)';
				ctx.fillRect(0,0,width,height);

                oldImageData = newImageData = outputImageData = ctx.getImageData(0, 0, width, height);

				//call draw every __ ms
				var id = setInterval(draw, 50);
			}

            function gen_palette()
            {
                for(var i = 0; i < 256; i++)
                {
                    HSLToRGB(i/3, 255, Math.min(255, i*2));
                }
            }

            function HSLToRGB(h,s,l)
            {
                // Must be fractions of 1
                s /= 255;
                l /= 255;

                let c = (1 - Math.abs(2 * l - 1)) * s,
                    x = c * (1 - Math.abs((h / 60) % 2 - 1)),
                    m = l - c/2,
                    r = 0,
                    g = 0,
                    b = 0;


                if (0 <= h && h < 60) {
                    r = c; g = x; b = 0;
                } else if (60 <= h && h < 120) {
                    r = x; g = c; b = 0;
                } else if (120 <= h && h < 180) {
                    r = 0; g = c; b = x;
                } else if (180 <= h && h < 240) {
                    r = 0; g = x; b = c;
                } else if (240 <= h && h < 300) {
                    r = x; g = 0; b = c;
                } else if (300 <= h && h < 360) {
                    r = c; g = 0; b = x;
                }

                r = Math.round((r + m) * 255);
                g = Math.round((g + m) * 255);
                b = Math.round((b + m) * 255);

                console.log("rgb(" + r + "," + g + "," + b + ")");
                paletteR.push(r);
                paletteG.push(g);
                paletteB.push(b);
            }

			function draw()
			{
				//get your context stuff
				canvas = document.getElementById('fire');
				ctx = canvas.getContext('2d');

				//establish width, with wide border (100px all edges)
				width = ctx.canvas.width  = 768;
				height = ctx.canvas.height = 75;

				//get old data
				oldImageData = newImageData;

				//new image data, with same dimensions
				newImageData = ctx.createImageData(oldImageData);

                //update the bottom row
                for(var x = 0; x < width; x++)
                {
                    oldImageData.data[(height-1)*width*4+x*4] = Math.random()*255;
                    //oldImageData.data[(height-1)*width*4+x*4] = Math.sin(0.3*x)*255;
                }

				//manipulate the data
                for(var	x = 0; x < width; x++)
                {
                    for(var y = 0; y < height; y++)
                    {
                        var avg = 0;

                        if(x == 0)
                        {
                            avg += oldImageData.data[(y+1)*width*4 + (width-1)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (x)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (x+1)*4];
                            avg += oldImageData.data[(y+2)*width*4 + (x)*4];
                        }
                        else if(x == width-1)
                        {
                            avg += oldImageData.data[(y+1)*width*4 + (x-1)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (x)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (0)*4];
                            avg += oldImageData.data[(y+2)*width*4 + (x)*4];
                        }
                        else
                        {
                            avg += oldImageData.data[(y+1)*width*4 + (x-1)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (x)*4];
                            avg += oldImageData.data[(y+1)*width*4 + (x+1)*4];
                            avg += oldImageData.data[(y+2)*width*4 + (x)*4];
                        }

                        //avg /= 4.0625;
                        //avg /= (129/32);
                        avg /= 3.9;

                        newImageData.data[y*width*4+x*4] = avg - 1;
					}
				}

                var outputImageData = ctx.createImageData(newImageData);

                for(var i = 0; i < 4 * width * height; i += 4)
                {
                    outputImageData.data[i]   = paletteR[newImageData.data[i]];
                    outputImageData.data[i+1] = paletteG[newImageData.data[i]];
                    outputImageData.data[i+2] = paletteB[newImageData.data[i]];
                    outputImageData.data[i+3] = 255;
                    //outputImageData.data[i+3] = paletteR[newImageData.data[i]];
                }

				//put the manipulated data back
				ctx.putImageData(outputImageData, 0, 0);
			}

        function report()
        {
            console.log("this has been reached");
        }
</script>

<script type="application/javascript">
            var gololdImageData;
            var golnewImageData;

            var golwidth;
            var golheight

            var golctx;
            var golcanvas;

			function startgol()
			{
				//get your context stuff
				golcanvas = document.getElementById('GoL');
				golctx = golcanvas.getContext('2d');

				//establish width, with wide border
				golwidth = golctx.canvas.width  = 768;
				golheight = golctx.canvas.height = 75;

                golnewImageData = golctx.createImageData(golwidth, golheight);

                for(var	x = 0; x < golwidth; x++)
                {
                    for(var y = 0; y < golheight; y++)
                    {
                        //write your initial image data
                        var val = Math.random() > 0.5 ? 255 : 0;
                        golnewImageData.data[y*golwidth*4+x*4+0] = val;
                        golnewImageData.data[y*golwidth*4+x*4+1] = val;
                        golnewImageData.data[y*golwidth*4+x*4+2] = val;
                        golnewImageData.data[y*golwidth*4+x*4+3] = 255;
					}
				}

				//call draw every __ ms
				var idgol = setInterval(drawgol, 50);
			}

			function drawgol()
			{
				//get your context stuff
				golcanvas = document.getElementById('GoL');
				golctx = golcanvas.getContext('2d');

				//establish width, with wide border (100px all edges)
				golwidth = golctx.canvas.width  = 768;
				golheight = golctx.canvas.height = 75;

				//get old data - that's the same as last frame's new data
				gololdImageData = golnewImageData;

				//new image data, with same dimensions
				golnewImageData = golctx.createImageData(gololdImageData);

				//manipulate the data
                for(var	x = 0; x < golwidth; x++)
                {
                    for(var y = 0; y < golheight; y++)
                    {
                        //read from oldImageData.data
                        var sum = 0;
                        var was_live = (gololdImageData.data[(y+0)*golwidth*4+(x+0)*4] == 255) ? 1 : 0;

                        sum += (gololdImageData.data[(y+1)*golwidth*4+(x+1)*4] == 255) ? 1 : 0;
                        sum += (gololdImageData.data[(y+1)*golwidth*4+(x+0)*4] == 255) ? 1 : 0;
                        sum += (gololdImageData.data[(y+1)*golwidth*4+(x-1)*4] == 255) ? 1 : 0;

                        sum += (gololdImageData.data[(y+0)*golwidth*4+(x+1)*4] == 255) ? 1 : 0;
                        sum += (gololdImageData.data[(y+0)*golwidth*4+(x-1)*4] == 255) ? 1 : 0;

                        sum += (gololdImageData.data[(y-1)*golwidth*4+(x+1)*4] == 255) ? 1 : 0;
                        sum += (gololdImageData.data[(y-1)*golwidth*4+(x+0)*4] == 255) ? 1 : 0;
                        sum += (gololdImageData.data[(y-1)*golwidth*4+(x-1)*4] == 255) ? 1 : 0;

                        //do your computation
                        var is_live = (was_live && (sum == 2 || sum == 3)) || (!was_live && sum == 3);

                        //cell lives when it has either 2 or three neighbors
                        golnewImageData.data[y*golwidth*4+x*4+0] = is_live ? 255 : 0;
                        golnewImageData.data[y*golwidth*4+x*4+1] = is_live ? 255 : 0;
                        golnewImageData.data[y*golwidth*4+x*4+2] = is_live ? 255 : 0;
                        golnewImageData.data[y*golwidth*4+x*4+3] = 255;

					}
				}

                //display the current data
				golctx.putImageData(golnewImageData, 0, 0);
			}
		</script>

<script type="application/javascript">
            var wireoldImageData;
            var wirenewImageData;

            var wirecanvas;
            var wirectx;

			function startwireworld()
			{
				// //get your context stuff
				// wirecanvas = document.getElementById('wireworldbg');
				// wirectx = wirecanvas.getContext('2d');
				//
				// wirewidth = wirectx.canvas.width  = 768;
				// wireheight = wirectx.canvas.height = 75;
				//
				// //initially fill with all black
				// wirectx.fillStyle = 'rgb(64,64,64,255)';
				// wirectx.fillRect(0,0,wirewidth,wireheight);

				wirecanvas = document.getElementById('wireworld');
				wirectx = wirecanvas.getContext('2d');
				wirectx.imageSmoothingEnabled = false;

				//establish width, with wide border (100px all edges)
				wirewidth = wirectx.canvas.width  = 768;
				wireheight = wirectx.canvas.height = 75;

                wirenewImageData = wirectx.createImageData(wirewidth, wireheight);


                for(var	x = 0; x < wirewidth; x++)
                {
                    for(var y = 0; y < wireheight; y++)
                    {
                        var sample = Math.random();
                        if(x%12==0 || y%8==0 && (x > 550 || x < 200))
                        {
                            if(sample > 0.999)
                            {
                                wirenewImageData.data[y*wirewidth*4+x*4+0] = 255;
                                wirenewImageData.data[y*wirewidth*4+x*4+1] = 255;
                                wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                            }
                            else
                            {
                                wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                            }
                        }
                        else
                        {
                            wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+3] = 0;
                        }
                        if(Math.random()< 0.2)
                        {
                            wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+3] = 0;
                        }
                        if(Math.random()< 0.4)
                        {
                            wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                        }
                        if((x > 63 && x < 634)&&(y > 25 && y < 75))
                        {
                            wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+3] = 0;
                        }
                        if((y%12)==0)
                        {
                            wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                            wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                        }
                    }
				}

				wirectx.putImageData(wirenewImageData, 0, 0);

				//call draw every __ ms
				var idwire = setInterval(drawwire, 50);
			}

			function drawwire()
			{
				//get old data - that's the same as last frame's new data
				wireoldImageData = wirenewImageData;

				//new image data, with same dimensions
				wirenewImageData = wirectx.createImageData(wireoldImageData);

				//manipulate the data
                for(var	x = 0; x < wirewidth; x++)
                {
                    for(var y = 0; y < wireheight; y++)
                    {
                        //read from oldImageData.data
												var was_conductor = true;
                        //red channel set, means electron head
                        var was_head = (wireoldImageData.data[(y+0)*wirewidth*4+(x+0)*4] == 255) ? 1 : 0;
                        //blue channel set, meads electron tail
                        var was_tail = (wireoldImageData.data[(y+0)*wirewidth*4+(x+0)*4+2] == 255) ? 1 : 0;


												//var has_alpha = (wireoldImageData.data[(y+0)*wirewidth*4+(x+0)*4+3] == 255) ? 1 : 0;
												// var has_alpha = 



                        //do your computation

                        if(was_head|was_tail|was_conductor)
                        {//part of the simulation
                            if(was_head)
                            {//this was a head, and will become a tail
                                wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+1] = 255;
                                wirenewImageData.data[y*wirewidth*4+x*4+2] = 255;
                                wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                            }
                            else if(was_tail)
                            {//this was a tail, and will become conductor
                                wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                                wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                            }
                            else
                            {//conductor, needs to check neighborhood
                                var sum = 0;
                                sum += (wireoldImageData.data[(y+1)*wirewidth*4+(x+1)*4] == 255) ? 1 : 0;
                                sum += (wireoldImageData.data[(y+1)*wirewidth*4+(x+0)*4] == 255) ? 1 : 0;
                                sum += (wireoldImageData.data[(y+1)*wirewidth*4+(x-1)*4] == 255) ? 1 : 0;

                                sum += (wireoldImageData.data[(y+0)*wirewidth*4+(x+1)*4] == 255) ? 1 : 0;
                                sum += (wireoldImageData.data[(y+0)*wirewidth*4+(x-1)*4] == 255) ? 1 : 0;

                                sum += (wireoldImageData.data[(y-1)*wirewidth*4+(x+1)*4] == 255) ? 1 : 0;
                                sum += (wireoldImageData.data[(y-1)*wirewidth*4+(x+0)*4] == 255) ? 1 : 0;
                                sum += (wireoldImageData.data[(y-1)*wirewidth*4+(x-1)*4] == 255) ? 1 : 0;
                                if(sum==1||sum==2)
                                {//this cell will become an electron head
                                    wirenewImageData.data[y*wirewidth*4+x*4+0] = 255;
                                    wirenewImageData.data[y*wirewidth*4+x*4+1] = 255;
                                    wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                                    wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                                }
                                else
                                {//int stays a conductor
                                    wirenewImageData.data[y*wirewidth*4+x*4+0] = 0;
                                    wirenewImageData.data[y*wirewidth*4+x*4+1] = 0;
                                    wirenewImageData.data[y*wirewidth*4+x*4+2] = 0;
                                    wirenewImageData.data[y*wirewidth*4+x*4+3] = 255;
                                }
                            }
                        }
					}
				}

				wirectx.putImageData(wirenewImageData, 0, 0);
			}
		</script>
</head>

<script type="application/javascript">

	var dlaImageData;
	var dlawidth;
	var dlaheight;

	var dlactx;
	var dlacanvas;

	function startDLA()
	{
		dlacanvas = document.getElementById('DLA');
		dlactx = dlacanvas.getContext('2d');

		dlawidth = dlactx.canvas.width = 768;
		dlaheight = dlactx.canvas.height = 75;

		dlaImageData = dlactx.createImageData(dlawidth, dlaheight);

		//call every 50 ms - function runs till a walker becomes stuck
		var iddla = setInterval(drawDLA, 50);
	}

	function drawDLA()
	{

	}

</script>

<body onload="startfire(); startgol(); startwireworld(); startDLA();">

    <h1>Jon Baker, Graphics Programming</h1>

<p>  &nbsp&nbsp&nbsp&nbsp        Refresh to reset. Click titles to go to a page with a larger canvas and explanation. &nbsp <a href='http://jbaker.graphics/index.html'>home</a></p>

<br>
<h2 style="display: inline-block;">&nbsp&nbsp Fire</h2>
<p style="display: inline-block;">based on <a href = "https://lodev.org/cgtutor/fire.html">this tutorial</a>.</p>

<br>
<p style="display: inline-block;"> &nbsp&nbsp &nbsp&nbsp &nbsp </p>
<canvas id="fire" style="border: 2px solid #ba550b;" >
	Could not load fire effect.
</canvas>
<br>


<h2>&nbsp&nbsp Conway's Game of Life</h2>
<p style="display: inline-block;"> &nbsp&nbsp &nbsp&nbsp &nbsp </p>
<canvas id="GoL" style="border: 2px solid #ba550b;">
	Could not load Game of Life.
</canvas>
<br>


<h2>&nbsp&nbsp WireWorld</h2>
<p style="display: inline-block;"> &nbsp&nbsp &nbsp&nbsp &nbsp </p>
<canvas id="wireworld" style="border: 2px solid #ba550b;">
	Wireworld loading failed.
</canvas>


<h2>&nbsp&nbsp Diffusion Limited Aggregation</h2>
<p style="display: inline-block;"> &nbsp&nbsp &nbsp&nbsp &nbsp </p>
<canvas id="DLA" style="border: 2px solid #ba550b;">Could not load Diffusion Limited Aggregation.</canvas>
<br>

</body>
</html>
